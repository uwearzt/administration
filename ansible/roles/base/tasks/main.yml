# ------------------------------------------------------------------------------
# Copyright 2018 Uwe Arzt, mail@uwe-arzt.de
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and 
# limitations under the License.
# ------------------------------------------------------------------------------

---    
- name: dnf install base packages 
  block:
    - dnf: name={{item}} state=present 
      with_items:
        - mosh
        - lsof
        - htop
        - fish
        - git
        - neovim
        - python3
        - python3-libselinux
        - python3-firewall
        - dnf-plugin-tracer
    - user:
        name: uwe
        shell: /usr/bin/fish

  when: ansible_os_family == "RedHat"
  become: true

# ------------------------------------------------------------------------------

- name: brew install base packages
  block:
    - homebrew: 
        name: "{{item}}" 
        state: present
        update_homebrew: yes
      with_items:
        - mosh
        - lsof
        - htop
        - fish
        - git
        - neovim

    - lineinfile:
        path: /etc/shells
        line: /usr/local/bin/fish
      become: true

    - user: 
        name: uwe 
        shell: /usr/local/bin/fish
      become: true

  when: ansible_os_family == "Darwin"

# ------------------------------------------------------------------------------

- name: copy config.fish
  copy: 
    src: files/config.fish 
    dest: .config/fish/
    backup: yes
- name: copy fish functions
  copy: 
    src: files/fish.functions/
    dest: .config/fish/functions/
    backup: yes

- name: copy .gitconfig
  copy: 
    src: files/gitconfig
    dest: .gitconfig
    backup: yes
